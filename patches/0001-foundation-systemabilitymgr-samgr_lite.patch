From abf165f0a2f57c0ad5b6c3509614d26d33b2ef42 Mon Sep 17 00:00:00 2001
From: zhushengle <zhushengle@huawei.com>
Date: Sat, 24 Sep 2022 09:11:23 +0800
Subject: [PATCH] =?UTF-8?q?feat:=20=E6=94=AF=E6=8C=81UniProton=E5=86=85?=
 =?UTF-8?q?=E6=A0=B8?=
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Signed-off-by: zhushengle <zhushengle@huawei.com>
Change-Id: I046525c68808962b352972180d58a05447f619d9
---
 BUILD.gn                         |  2 +-
 bundle.json                      |  3 ++-
 communication/broadcast/BUILD.gn |  2 +-
 samgr/BUILD.gn                   |  2 +-
 samgr/adapter/BUILD.gn           | 12 +++++++-----
 samgr/source/BUILD.gn            |  2 +-
 6 files changed, 13 insertions(+), 10 deletions(-)

diff --git a/BUILD.gn b/BUILD.gn
index 636562c..d64ad05 100755
--- a/BUILD.gn
+++ b/BUILD.gn
@@ -41,7 +41,7 @@ copy("ConfigFiles") {
 }
 
 ndk_lib("samgr_lite_ndk") {
-  if (ohos_kernel_type == "liteos_m") {
+  if (ohos_kernel_type == "liteos_m" || ohos_kernel_type == "uniproton") {
     lib_extension = ".a"
   } else if (ohos_kernel_type == "liteos_a" || ohos_kernel_type == "linux") {
     lib_extension = ".so"
diff --git a/bundle.json b/bundle.json
index 019313b..1c028e9 100644
--- a/bundle.json
+++ b/bundle.json
@@ -20,6 +20,7 @@
         "adapted_kernel": [
             "liteos_a",
             "liteos_m",
+            "uniproton",
             "linux"
         ],
         "rom": "62KB",
@@ -40,4 +41,4 @@
             ]
         }
     }
-}
\ No newline at end of file
+}
diff --git a/communication/broadcast/BUILD.gn b/communication/broadcast/BUILD.gn
index 51fd524..0823025 100755
--- a/communication/broadcast/BUILD.gn
+++ b/communication/broadcast/BUILD.gn
@@ -20,7 +20,7 @@ config("broadcast_public") {
   ]
 }
 
-if (ohos_kernel_type == "liteos_m") {
+if (ohos_kernel_type == "liteos_m" || ohos_kernel_type == "uniproton") {
   static_library("broadcast") {
     sources = [
       "source/broadcast_service.c",
diff --git a/samgr/BUILD.gn b/samgr/BUILD.gn
index 3e22d90..9945161 100644
--- a/samgr/BUILD.gn
+++ b/samgr/BUILD.gn
@@ -34,7 +34,7 @@ config("samgr_public") {
   ]
 }
 
-if (ohos_kernel_type == "liteos_m") {
+if (ohos_kernel_type == "liteos_m" || ohos_kernel_type == "uniproton") {
   static_library("samgr") {
     sources = [
       "registry/service_registry.c",
diff --git a/samgr/adapter/BUILD.gn b/samgr/adapter/BUILD.gn
index d0c41af..d2d2d5a 100755
--- a/samgr/adapter/BUILD.gn
+++ b/samgr/adapter/BUILD.gn
@@ -19,7 +19,7 @@ config("samgr_adapter_public") {
   ]
 }
 
-if (ohos_kernel_type == "liteos_m") {
+if (ohos_kernel_type == "liteos_m" || ohos_kernel_type == "uniproton") {
   static_library("samgr_adapter") {
     sources = [
       "cmsis/memory_adapter.c",
@@ -30,10 +30,12 @@ if (ohos_kernel_type == "liteos_m") {
 
     public_configs = [ ":samgr_adapter_public" ]
 
-    include_dirs = [
-      "//kernel/liteos_m/kal/",
-      "//kernel/liteos_m/kal/cmsis",
-    ]
+    if (ohos_kernel_type == "liteos_m") {
+      include_dirs = [
+        "//kernel/liteos_m/kal/",
+        "//kernel/liteos_m/kal/cmsis",
+      ]
+    }
   }
 }
 
diff --git a/samgr/source/BUILD.gn b/samgr/source/BUILD.gn
index 30c7b79..4b81e2d 100755
--- a/samgr/source/BUILD.gn
+++ b/samgr/source/BUILD.gn
@@ -23,7 +23,7 @@ config("samgr_source_public") {
   ]
 }
 
-if (ohos_kernel_type == "liteos_m") {
+if (ohos_kernel_type == "liteos_m" || ohos_kernel_type == "uniproton") {
   static_library("samgr_source") {
     sources = [
       "common.c",
-- 
2.17.1

